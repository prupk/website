DataBNAPakistan %>%
fgroup_by(REGION, Q8) %>%
fsummarise(Resp = fnobs(Q8))
) %>%
fmutate(Q8 = fct_relevel(.f = Q8, c("POS (Through BVS)", "ATM (Through BVS)", "Non BVS"))) %>%
fgroup_by(REGION) %>%
fmutate(RespP = round(100*Resp/fsum(Resp))) %>%
fungroup() %>%
ggplot(data = ., mapping = aes(x = REGION, y = RespP, fill = fct_rev(Q8))) +
geom_col(width = 0.75) +
coord_flip()  +
geom_text(
mapping = aes(
label = if_else.(
condition =  Q8 == "POS (Through BVS)"
,  true = paste0(comma(Resp), " (", RespP, "\\%)")
, false = " ")), fontface = "bold", size = 4.5, position = position_stack(vjust = 0.5))  +
scale_x_discrete(limits = rev) +
scale_y_continuous(expand = c(0, 0), labels = scales::comma, breaks = breaks_pretty(8)) +
labs(
x     = " "
, y     = " "
, fill  = " "
, title = "Mode of receiving Payment"
) +
theme_classic() +
theme(
legend.position = "top"
, plot.title = element_text(hjust = 0.5)
) +
guides(fill = guide_legend(reverse = TRUE)) +
myTheme1()
PakBNAQ8Plot1
PakBNAQ4Plot1
library(tikzDevice)
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/BISP/04-CT/2023-02-03_BNA_Survey_Pakistan/FiguresTikz")
tikz(
file       = "PakBNAQ8Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ8Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ8Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ8Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ8Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ8Plot1.png"
, dpi       = 300
)
library(tikzDevice)
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/BISP/04-CT/2023-02-03_BNA_Survey_Pakistan/FiguresTikz")
tikz(
file       = "PakBNAQ5Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ5Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ5Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ5Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ5Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ5Plot1.png"
, dpi       = 300
)
tikz(
file       = "PakBNAQ6Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ6Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ6Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ6Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ6Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ6Plot1.png"
, dpi       = 300
)
library(tikzDevice)
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/BISP/04-CT/2023-02-03_BNA_Survey_Pakistan/FiguresTikz")
tikz(
file       = "PakBNAQ5Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ5Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ5Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ5Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ5Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ5Plot1.png"
, dpi       = 300
)
tikz(
file       = "PakBNAQ6Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ6Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ6Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ6Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ6Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ6Plot1.png"
, dpi       = 300
)
PakBNAQ5Plot1 <-
DataBNAPakistan %>%
fselect(REGION, Q5) %>%
fgroup_by(Q5) %>%
fsummarise(Resp = fnobs(Q5)) %>%
bind_cols.(REGION = as_factor("Pakistan")) %>%
colorder(REGION, pos = "front") %>%
bind_rows.(
DataBNAPakistan %>%
fgroup_by(REGION, Q5) %>%
fsummarise(Resp = fnobs(Q5))
) %>%
fmutate(Q5 = fct_relevel(.f = Q5, c("Yes", "No"))) %>%
fgroup_by(REGION) %>%
fmutate(RespP = round(100*Resp/fsum(Resp))) %>%
fungroup() %>%
ggplot(data = ., mapping = aes(x = REGION, y = RespP, fill = fct_rev(Q5))) +
geom_col(width = 0.75) +
coord_flip() +
geom_text(mapping = aes(label = paste0(comma(Resp), " (", RespP, "\\%)")), fontface = "bold", size = 4.5, position = position_stack(vjust = 0.5)) +
scale_x_discrete(limits = rev) +
scale_y_continuous(expand = c(0, 0), labels = scales::comma, breaks = breaks_pretty(8), limits = c(0, 105)) +
labs(
x     = " "
, y     = " "
, fill  = " "
, title = "Awareness about existing BISP Payment Mechanism"
) +
theme_classic() +
theme(
legend.position = "top"
, plot.title = element_text(hjust = 0.5)
) +
guides(fill = guide_legend(reverse = TRUE)) +
myTheme1()
PakBNAQ5Plot1
PakBNAQ6Plot1 <-
DataBNAPakistan %>%
fselect(REGION, Q6) %>%
fgroup_by(Q6) %>%
fsummarise(Resp = fnobs(Q6)) %>%
bind_cols.(REGION = as_factor("Pakistan")) %>%
colorder(REGION, pos = "front") %>%
bind_rows.(
DataBNAPakistan %>%
fgroup_by(REGION, Q6) %>%
fsummarise(Resp = fnobs(Q6))
) %>%
fmutate(Q6 = fct_relevel(.f = Q6, c("Yes", "No"))) %>%
fgroup_by(REGION) %>%
fmutate(RespP = round(100*Resp/fsum(Resp))) %>%
fungroup() %>%
ggplot(data = ., mapping = aes(x = REGION, y = RespP, fill = fct_rev(Q6))) +
geom_col(width = 0.75) +
coord_flip() +
geom_text(mapping = aes(label = paste0(comma(Resp), " (", RespP, "\\%)")), fontface = "bold", size = 4.5, position = position_stack(vjust = 0.5)) +
scale_x_discrete(limits = rev) +
scale_y_continuous(expand = c(0, 0), labels = scales::comma, breaks = breaks_pretty(8), limits = c(0, 105)) +
labs(
x     = " "
, y     = " "
, fill  = " "
, title = "Awareness about current quarterly BISP stipend amount"
) +
theme_classic() +
theme(
legend.position = "top"
, plot.title = element_text(hjust = 0.5)
) +
guides(fill = guide_legend(reverse = TRUE)) +
myTheme1()
PakBNAQ6Plot1
library(tikzDevice)
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/BISP/04-CT/2023-02-03_BNA_Survey_Pakistan/FiguresTikz")
tikz(
file       = "PakBNAQ5Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ5Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ5Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ5Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ5Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ5Plot1.png"
, dpi       = 300
)
tikz(
file       = "PakBNAQ6Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ6Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ6Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ6Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ6Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ6Plot1.png"
, dpi       = 300
)
PakBNAQ10Plot1 <-
BNAPakistanQ10 %>%
multiResponse(
data           =
, items          = c("Q10.1", "Q10.2", "Q10.3", "Q10.4")
, regex          = NULL
, perlRegex      = TRUE
, endorsedOption = 1
) %>%
select(1:3) %>%
set_names("Options", "Frequency", "Percentage") %>%
bind_cols.(REGION = as_factor("Pakistan")) %>%
colorder(REGION, pos = "front") %>%
bind_rows.(
BNAPakistanQ10 %>%
group_by(REGION) %>%
group_map(
.data = .
, .f = ~ multiResponse(
data           = .
, items          = c("Q10.1", "Q10.2", "Q10.3", "Q10.4")
, regex          = NULL
, perlRegex      = TRUE
, endorsedOption = 1
) %>%
select(1:3) %>%
set_names("Options", "Frequency", "Percentage")
, .keep = TRUE
) %>%
set_names(levels(as.factor(BNAPakistanQ10$REGION))) %>%
bind_rows.(.id = "REGION") %>%
fmutate(REGION = fct_relevel(.f = REGION, c("Punjab", "Sindh", "KP", "Balochistan", "AJK", "GB")))
) %>%
fsubset(Options != "Total") %>%
frename(Options = Q10, Frequency = Freq, Percentage = Perc) %>%
fmutate(
Q10 = fct_recode(
.f          = Q10
, "Near Home"                 = "Q10.1"
, "No waiting in long queues" = "Q10.2"
, "Receive full stipend"      = "Q10.3"
, "Any other"                 = "Q10.4"
)
) %>%
fmutate(Perc = round(Perc)) %>%
ggplot(data = ., mapping = aes(x = REGION, y = Perc, fill = fct_rev(Q10))) +
geom_col(width = 0.75) +
coord_flip() +
geom_text(mapping = aes(label = paste0(comma(Freq), " (", Perc, "\\%)")), fontface = "bold", size = 4.5, position = position_stack(vjust = 0.5)) +
scale_x_discrete(limits = rev) +
scale_y_continuous(expand = c(0, 0), labels = scales::comma, breaks = breaks_pretty(8), limits = c(0, 105)) +
labs(
x     = " "
, y     = " "
, fill  = " "
, title = "Awareness about existing BISP Payment Mechanism"
) +
theme_classic() +
theme(
legend.position = "top"
, plot.title = element_text(hjust = 0.5)
) +
guides(fill = guide_legend(reverse = TRUE)) +
myTheme1()
PakBNAQ10Plot1
library(tikzDevice)
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/BISP/04-CT/2023-02-03_BNA_Survey_Pakistan/FiguresTikz")
tikz(
file       = "PakBNAQ10Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ10Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ10Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ10Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ10Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ10Plot1.png"
, dpi       = 300
)
pdf_convert(
pdf       = "PakBNAQ10Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ10Plot1.png"
, dpi       = 300
)
library(tikzDevice)
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/BISP/04-CT/2023-02-03_BNA_Survey_Pakistan/FiguresTikz")
tikz(
file       = "PakBNAQ10Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ10Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ10Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ10Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ10Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ10Plot1.png"
, dpi       = 300
)
PakBNAQ8Plot1 <-
DataBNAPakistan %>%
fselect(REGION, Q8) %>%
fgroup_by(Q8) %>%
fsummarise(Resp = fnobs(Q8)) %>%
bind_cols.(REGION = as_factor("Pakistan")) %>%
colorder(REGION, pos = "front") %>%
bind_rows.(
DataBNAPakistan %>%
fgroup_by(REGION, Q8) %>%
fsummarise(Resp = fnobs(Q8))
) %>%
fmutate(Q8 = fct_relevel(.f = Q8, c("POS (Through BVS)", "ATM (Through BVS)", "Non BVS"))) %>%
fgroup_by(REGION) %>%
fmutate(RespP = round(100*Resp/fsum(Resp))) %>%
fungroup() %>%
ggplot(data = ., mapping = aes(x = REGION, y = RespP, fill = fct_rev(Q8))) +
geom_col(width = 0.75) +
coord_flip()  +
geom_text(
mapping = aes(
label = if_else.(
condition =  Q8 == "POS (Through BVS)"
,  true = paste0(comma(Resp), " (", RespP, "\\%)")
, false = " ")), fontface = "bold", size = 4.5, position = position_stack(vjust = 0.5))  +
scale_x_discrete(limits = rev) +
scale_y_continuous(expand = c(0, 0), labels = scales::comma, breaks = breaks_pretty(8), limits = c(0, 105)) +
labs(
x     = " "
, y     = " "
, fill  = " "
, title = "Mode of receiving Payment"
) +
theme_classic() +
theme(
legend.position = "top"
, plot.title = element_text(hjust = 0.5)
) +
guides(fill = guide_legend(reverse = TRUE)) +
myTheme1()
PakBNAQ8Plot1
library(tikzDevice)
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/BISP/04-CT/2023-02-03_BNA_Survey_Pakistan/FiguresTikz")
tikz(
file       = "PakBNAQ8Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ8Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ8Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ8Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ8Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ8Plot1.png"
, dpi       = 300
)
PakBNAQ10Plot1 <-
BNAPakistanQ10 %>%
multiResponse(
data           =
, items          = c("Q10.1", "Q10.2", "Q10.3", "Q10.4")
, regex          = NULL
, perlRegex      = TRUE
, endorsedOption = 1
) %>%
select(1:3) %>%
set_names("Options", "Frequency", "Percentage") %>%
bind_cols.(REGION = as_factor("Pakistan")) %>%
colorder(REGION, pos = "front") %>%
bind_rows.(
BNAPakistanQ10 %>%
group_by(REGION) %>%
group_map(
.data = .
, .f = ~ multiResponse(
data           = .
, items          = c("Q10.1", "Q10.2", "Q10.3", "Q10.4")
, regex          = NULL
, perlRegex      = TRUE
, endorsedOption = 1
) %>%
select(1:3) %>%
set_names("Options", "Frequency", "Percentage")
, .keep = TRUE
) %>%
set_names(levels(as.factor(BNAPakistanQ10$REGION))) %>%
bind_rows.(.id = "REGION") %>%
fmutate(REGION = fct_relevel(.f = REGION, c("Punjab", "Sindh", "KP", "Balochistan", "AJK", "GB")))
) %>%
fsubset(Options != "Total") %>%
frename(Options = Q10, Frequency = Freq, Percentage = Perc) %>%
fmutate(
Q10 = fct_recode(
.f          = Q10
, "Near Home"                 = "Q10.1"
, "No waiting in long queues" = "Q10.2"
, "Receive full stipend"      = "Q10.3"
, "Any other"                 = "Q10.4"
)
) %>%
fmutate(Perc = round(Perc)) %>%
ggplot(data = ., mapping = aes(x = REGION, y = Perc, fill = fct_rev(Q10))) +
geom_col(width = 0.75) +
coord_flip() +
geom_text(mapping = aes(label = paste0(comma(Freq), " (", Perc, "\\%)")), fontface = "bold", size = 4.5, position = position_stack(vjust = 0.5)) +
scale_x_discrete(limits = rev) +
scale_y_continuous(expand = c(0, 0), labels = scales::comma, breaks = breaks_pretty(8), limits = c(0, 105)) +
labs(
x     = " "
, y     = " "
, fill  = " "
, title = "Reasons for using same POS Agent (Multiple Responses)"
) +
theme_classic() +
theme(
legend.position = "top"
, plot.title = element_text(hjust = 0.5)
) +
guides(fill = guide_legend(reverse = TRUE)) +
myTheme1()
PakBNAQ10Plot1
library(tikzDevice)
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/BISP/04-CT/2023-02-03_BNA_Survey_Pakistan/FiguresTikz")
tikz(
file       = "PakBNAQ10Plot1.tex"
,  standAlone = TRUE
,  width     = 11.69
,  height    = 8.27
)
PakBNAQ10Plot1
dev.off()
tinytex::pdflatex(file = "PakBNAQ10Plot1.tex")
system(paste(getOption("pdfviewer"), "PakBNAQ10Plot1.pdf"))
pdf_convert(
pdf       = "PakBNAQ10Plot1.pdf"
, format    = "png"
, pages     = NULL
, filenames = "PakBNAQ10Plot1.png"
, dpi       = 300
)
# rm(list = ls())
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/PRU/Website/Website")
getwd()
# renv::snapshot()
library(rmarkdown)
library(quarto)
quarto_render()
quarto_preview()
# rm(list = ls())
setwd("D:/MYaseen208_B0-22-7A-E9-23-9B/Consultancy/PRU/Website/Website")
getwd()
# renv::snapshot()
library(rmarkdown)
library(quarto)
quarto_render()
quarto_preview()
quarto_preview_stop()
quarto_render()
quarto_preview()
# renv::snapshot()
library(rmarkdown)
library(quarto)
quarto_render()
quarto_render()
quarto_preview()
